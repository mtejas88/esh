plot(merge_cable30sIA$"Mbps.Down.Speed",merge_cable30sIA$cost_per_mbps, main="Town Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="red3")
abline(powerfit_cable30sIA, untf=FALSE, col="red3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl30sIA$"Mbps.Down.Speed",merge_dsl30sIA$cost_per_mbps, main="Town Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="red3")
abline(powerfit_dsl30sIA, untf=FALSE, col="red3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_fiber40sIA$"Mbps.Down.Speed",merge_fiber40sIA$cost_per_mbps, main="Rural Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_fiber40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable40sIA$"Mbps.Down.Speed",merge_cable40sIA$cost_per_mbps, main="Rural Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_cable40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl40sIA$"Mbps.Down.Speed",merge_dsl40sIA$cost_per_mbps, main="Rural Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
dev.off()
par(mfrow=c(4,3))
plot(merge_fiber10sIA$"Mbps.Down.Speed",merge_fiber10sIA$cost_per_mbps, main="City Fiber IA", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber10sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber10sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable10sIA$"Mbps.Down.Speed",merge_cable10sIA$cost_per_mbps, main="City Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable10sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable10sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl10sIA$"Mbps.Down.Speed",merge_dsl10sIA$cost_per_mbps, main="City Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl10sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl10sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_fiber20sIA$"Mbps.Down.Speed",merge_fiber20sIA$cost_per_mbps, main="Suburban Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber20sIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber20sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable20sIA$"Mbps.Down.Speed",merge_cable20sIA$cost_per_mbps, main="Suburban Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable20sIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable20sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(1, type="n", axes=F, xlab="", ylab="")
plot(merge_fiber30sIA$"Mbps.Down.Speed",merge_fiber30sIA$cost_per_mbps, main="Town Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber30sIA, untf=FALSE, col="red3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable30sIA$"Mbps.Down.Speed",merge_cable30sIA$cost_per_mbps, main="Town Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable30sIA, untf=FALSE, col="red3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl30sIA$"Mbps.Down.Speed",merge_dsl30sIA$cost_per_mbps, main="Town Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl30sIA, untf=FALSE, col="red3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_fiber40sIA$"Mbps.Down.Speed",merge_fiber40sIA$cost_per_mbps, main="Rural Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable40sIA$"Mbps.Down.Speed",merge_cable40sIA$cost_per_mbps, main="Rural Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl40sIA$"Mbps.Down.Speed",merge_dsl40sIA$cost_per_mbps, main="Rural Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
dev.off()
par(mfrow=c(4,3))
plot(merge_fiber10sIA$"Mbps.Down.Speed",merge_fiber10sIA$cost_per_mbps, main="City Fiber IA", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber10sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber10sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable10sIA$"Mbps.Down.Speed",merge_cable10sIA$cost_per_mbps, main="City Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable10sIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable10sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl10sIA$"Mbps.Down.Speed",merge_dsl10sIA$cost_per_mbps, main="City Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl10sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl10sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_fiber20sIA$"Mbps.Down.Speed",merge_fiber20sIA$cost_per_mbps, main="Suburban Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber20sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber20sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable20sIA$"Mbps.Down.Speed",merge_cable20sIA$cost_per_mbps, main="Suburban Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable20sIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable20sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(1, type="n", axes=F, xlab="", ylab="")
plot(merge_fiber30sIA$"Mbps.Down.Speed",merge_fiber30sIA$cost_per_mbps, main="Town Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber30sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable30sIA$"Mbps.Down.Speed",merge_cable30sIA$cost_per_mbps, main="Town Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable30sIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl30sIA$"Mbps.Down.Speed",merge_dsl30sIA$cost_per_mbps, main="Town Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl30sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl30sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_fiber40sIA$"Mbps.Down.Speed",merge_fiber40sIA$cost_per_mbps, main="Rural Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiber40sIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiber40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cable40sIA$"Mbps.Down.Speed",merge_cable40sIA$cost_per_mbps, main="Rural Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cable40sIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cable40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dsl40sIA$"Mbps.Down.Speed",merge_dsl40sIA$cost_per_mbps, main="Rural Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dsl40sIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dsl40sIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
--plot connect types
dev.off()
par(mfrow=c(1,3))
plot(merge_dslIA$"Mbps.Down.Speed",merge_dslIA$cost_per_mbps, main="Rural Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dslIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dslIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
dev.off()
par(mfrow=c(1,3))
plot(merge_fiberIA$"Mbps.Down.Speed",merge_fiber40sIA$cost_per_mbps, main="Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiberIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiberIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cableIA$"Mbps.Down.Speed",merge_cable40sIA$cost_per_mbps, main="Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cableIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cableIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dslIA$"Mbps.Down.Speed",merge_dslIA$cost_per_mbps, main="Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dslIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dslIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
dev.off()
par(mfrow=c(1,3))
plot(merge_fiberIA$"Mbps.Down.Speed",merge_fiberIA$cost_per_mbps, main="Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiberIA, untf=FALSE, col="springgreen4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_fiberIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_cableIA$"Mbps.Down.Speed",merge_cableIA$cost_per_mbps, main="Cable Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="turquoise4")
abline(powerfit_cableIA, untf=FALSE, col="turquoise4")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_cableIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
plot(merge_dslIA$"Mbps.Down.Speed",merge_dslIA$cost_per_mbps, main="Dsl Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="maroon3")
abline(powerfit_dslIA, untf=FALSE, col="maroon3")
mylabel = bquote(italic(R)^2 == .(format(summary(powerfit_dslIA)$adj.r.squared, digits = 3)))
text(x = 19, y = .5, labels = mylabel)
dev.off()
par(mfrow=c(1,3))
plot(merge_fiberIA$"Mbps.Down.Speed",merge_fiberIA$cost_per_mbps, main="Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiberIA, untf=FALSE, col="springgreen4")
points(merge_cableIA$"Mbps.Down.Speed",merge_cableIA$cost_per_mbps, main="Cable Internet Access", pch=16, col="turquoise4")
abline(powerfit_cableIA, untf=FALSE, col="turquoise4")
points(merge_dslIA$"Mbps.Down.Speed",merge_dslIA$cost_per_mbps, main="Dsl Internet Access", pch=16, log="xy", col="maroon3")
abline(powerfit_dslIA, untf=FALSE, col="maroon3")
dev.off()
par(mfrow=c(1,3))
plot(merge_fiberIA$"Mbps.Down.Speed",merge_fiberIA$cost_per_mbps, main="Fiber Internet Access", pch=16, log="xy", xlim=c(0.01, 100000), ylim=c(0.01, 100000), col="springgreen4")
abline(powerfit_fiberIA, untf=FALSE, col="springgreen4")
points(merge_cableIA$"Mbps.Down.Speed",merge_cableIA$cost_per_mbps, main="Cable Internet Access", pch=16, col="turquoise4")
abline(powerfit_cableIA, untf=FALSE, col="turquoise4")
points(merge_dslIA$"Mbps.Down.Speed",merge_dslIA$cost_per_mbps, main="Dsl Internet Access", pch=16, log="xy", col="maroon3")
abline(powerfit_dslIA, untf=FALSE, col="maroon3")
q()
usac2015 = read.csv("usac2015_31_3.csv", header=TRUE, sep="|")
usac2015$qty_bdwdth <- (usac2015$"No..of.Lines"*usac2015$"Mbps.Down.Speed")
usac2015$cost_per_mbps <- ifelse(usac2015$qty_bdwdth == 0, 0, (usac2015$"Total.Cost"/12/usac2015$qty_bdwdth))
usac2015$lny <- log10(usac2015$cost_per_mbps)
usac2015$lnx <- log10(usac2015$"Mbps.Down.Speed")
mergeIA <- usac2015[(usac2015$"Purpose"=="Internet"),]
mergeIA <- mergeIA[rowSums(is.na(mergeIA)) == 0,]
merge_fiberIA <- mergeIA[mergeIA$"Connect.Type"=="Lit Fiber Service" | mergeIA$"Connect.Type"=="OC-N",]
merge_cableIA <- mergeIA[mergeIA$"Connect.Type"=="Cable Modem",]
merge_dslIA <- mergeIA[mergeIA$"Connect.Type"=="Digital Subscriber Line (DSL)",]
merge_t1IA <- mergeIA[mergeIA$"Connect.Type"=="DS-1 (T-1)",]
merge_t3IA <- mergeIA[mergeIA$"Connect.Type"=="DS-3 (T-3)",]
merge_darkfiberIA <- mergeIA[mergeIA$"Connect.Type"=="Dark Fiber Service",]
merge_wirelessIA <- mergeIA[mergeIA$"Connect.Type"=="E.g., Microwave Service",]
merge10sIA <- usac2015[((usac2015$locale==11 | usac2015$locale==12 | usac2015$locale==13) & usac2015$"Purpose"=="Internet"),]
merge20sIA <- usac2015[((usac2015$locale==21 | usac2015$locale==22 | usac2015$locale==23) & usac2015$"Purpose"=="Internet"),]
merge30sIA <- usac2015[((usac2015$locale==31 | usac2015$locale==32 | usac2015$locale==33) & usac2015$"Purpose"=="Internet"),]
merge40sIA <- usac2015[((usac2015$locale==41 | usac2015$locale==42 | usac2015$locale==43) & usac2015$"Purpose"=="Internet"),]
merge41IA <- usac2015[(usac2015$locale==41 & usac2015$"Purpose"=="Internet"),]
merge42IA <- usac2015[(usac2015$locale==42 & usac2015$"Purpose"=="Internet"),]
merge43IA <- usac2015[(usac2015$locale==43& usac2015$"Purpose"=="Internet"),]
merge_urbanIA <- rbind(merge10sIA, merge20sIA)
merge_subtwnIA <- rbind(merge30sIA, merge20sIA)
merge_ruralIA <- rbind(merge30sIA, merge40sIA)
merge_fiber10sIA <- merge10sIA[merge10sIA$"Connect.Type"=="Lit Fiber Service" | merge10sIA$"Connect.Type"=="OC-N",]
merge_cable10sIA <- merge10sIA[merge10sIA$"Connect.Type"=="Cable Modem",]
merge_dsl10sIA <- merge10sIA[merge10sIA$"Connect.Type"=="Digital Subscriber Line (DSL)",]
merge_t110sIA <- merge10sIA[merge10sIA$"Connect.Type"=="DS-1 (T-1)",]
merge_fiber20sIA <- merge20sIA[merge20sIA$"Connect.Type"=="Lit Fiber Service" | merge20sIA$"Connect.Type"=="OC-N",]
merge_cable20sIA <- merge20sIA[merge20sIA$"Connect.Type"=="Cable Modem",]
merge_t120sIA <- merge20sIA[merge20sIA$"Connect.Type"=="DS-1 (T-1)",]
merge_fiber30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="Lit Fiber Service" | merge30sIA$"Connect.Type"=="OC-N",]
merge_cable30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="Cable Modem",]
merge_dsl30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="Digital Subscriber Line (DSL)",]
merge_t130sIA <- merge30sIA[merge30sIA$"Connect.Type"=="DS-1 (T-1
merge_darkfiber30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="Dark Fiber Service",]
merge_wireless30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="E.g., Microwave Service",]
merge_fiber40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Lit Fiber Service" | merge40sIA$"Connect.Type"=="OC-N",]
merge_cable40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Cable Modem",]
merge_dsl40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Digital Subscriber Line (DSL)",]
merge_t140sIA <- merge40sIA[merge40sIA$"Connect.Type"=="DS-1 (T-1)",]
merge_t340sIA <- merge40sIA[merge40sIA$"Connect.Type"=="DS-3 (T-3)",]
merge_darkfiber40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Dark Fiber Service",]
merge_wireless40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="E.g., Microwave Service",]
merge10sIA <- merge10sIA[rowSums(is.na(merge10sIA)) == 0,]
merge20sIA <- merge20sIA[rowSums(is.na(merge20sIA)) == 0,]
merge30sIA <- merge30sIA[rowSums(is.na(merge30sIA)) == 0,]
merge40sIA <- merge40sIA[rowSums(is.na(merge40sIA)) == 0,]
merge41IA <- merge41IA[rowSums(is.na(merge41IA)) == 0,]
merge42IA <- merge42IA[rowSums(is.na(merge42IA)) == 0,]
merge43IA <- merge43IA[rowSums(is.na(merge43IA)) == 0,]
merge_urbanIA <- merge_urbanIA[rowSums(is.na(merge_urbanIA)) == 0,]
merge_subtwnIA <- merge_subtwnIA[rowSums(is.na(merge_subtwnIA)) == 0,]
merge_ruralIA <- merge_ruralIA[rowSums(is.na(merge_ruralIA)) == 0,]
merge_fiber10sIA <- merge_fiber10sIA[rowSums(is.na(merge_fiber10sIA)) == 0,]
merge_cable10sIA <- merge_cable10sIA[rowSums(is.na(merge_cable10sIA)) == 0,]
merge_dsl10sIA <- merge_dsl10sIA[rowSums(is.na(merge_dsl10sIA)) == 0,]
merge_t110sIA <- merge_t110sIA[rowSums(is.na(merge_t110sIA)) == 0,]
merge_fiber20sIA <- merge_fiber20sIA[rowSums(is.na(merge_fiber20sIA)) == 0,]
merge_cable20sIA <- merge_cable20sIA[rowSums(is.na(merge_cable20sIA)) == 0,]
merge_t120sIA <- merge_t120sIA[rowSums(is.na(merge_t120sIA)) == 0,]
merge_fiber30sIA <- merge_fiber30sIA[rowSums(is.na(merge_fiber30sIA)) == 0,]
merge_cable30sIA <- merge_cable30sIA[rowSums(is.na(merge_cable30sIA)) == 0,]
merge_dsl30sIA <- merge_dsl30sIA[rowSums(is.na(merge_dsl30sIA)) == 0,]
merge_t130sIA <- merge_t130sIA[rowSums(is.na(merge_t130sIA)) == 0,]
merge_darkfiber30sIA <- merge_darkfiber30sIA[rowSums(is.na(merge_darkfiber30sIA)) == 0,]
merge_wireless30sIA <- merge_wireless30sIA[rowSums(is.na(merge_wireless30sIA)) == 0,]
merge_fiber40sIA <- merge_fiber40sIA[rowSums(is.na(merge_fiber40sIA)) == 0,]
merge_cable40sIA <- merge_cable40sIA[rowSums(is.na(merge_cable40sIA)) == 0,]
merge_dsl40sIA <- merge_dsl40sIA[rowSums(is.na(merge_dsl40sIA)) == 0,]
merge_t140sIA <- merge_t140sIA[rowSums(is.na(merge_t140sIA)) == 0,]
merge_t340sIA <- merge_t340sIA[rowSums(is.na(merge_t340sIA)) == 0,]
merge_darkfiber40sIA <- merge_darkfiber40sIA[rowSums(is.na(merge_darkfiber40sIA)) == 0,]
merge_wireless40sIA <- merge_wireless40sIA[rowSums(is.na(merge_wireless40sIA)) == 0,]
merge_t130sIA <- merge30sIA[merge30sIA$"Connect.Type"=="DS-1 (T-1)",]
merge_darkfiber30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="Dark Fiber Service",]
merge_wireless30sIA <- merge30sIA[merge30sIA$"Connect.Type"=="E.g., Microwave Service",]
merge_fiber40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Lit Fiber Service" | merge40sIA$"Connect.Type"=="OC-N",]
merge_cable40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Cable Modem",]
merge_dsl40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Digital Subscriber Line (DSL)",]
merge_t140sIA <- merge40sIA[merge40sIA$"Connect.Type"=="DS-1 (T-1)",]
merge_t340sIA <- merge40sIA[merge40sIA$"Connect.Type"=="DS-3 (T-3)",]
merge_darkfiber40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="Dark Fiber Service",]
merge_wireless40sIA <- merge40sIA[merge40sIA$"Connect.Type"=="E.g., Microwave Service",]
merge10sIA <- merge10sIA[rowSums(is.na(merge10sIA)) == 0,]
merge20sIA <- merge20sIA[rowSums(is.na(merge20sIA)) == 0,]
merge30sIA <- merge30sIA[rowSums(is.na(merge30sIA)) == 0,]
merge40sIA <- merge40sIA[rowSums(is.na(merge40sIA)) == 0,]
merge41IA <- merge41IA[rowSums(is.na(merge41IA)) == 0,]
merge42IA <- merge42IA[rowSums(is.na(merge42IA)) == 0,]
merge43IA <- merge43IA[rowSums(is.na(merge43IA)) == 0,]
merge_urbanIA <- merge_urbanIA[rowSums(is.na(merge_urbanIA)) == 0,]
merge_subtwnIA <- merge_subtwnIA[rowSums(is.na(merge_subtwnIA)) == 0,]
merge_ruralIA <- merge_ruralIA[rowSums(is.na(merge_ruralIA)) == 0,]
merge_fiber10sIA <- merge_fiber10sIA[rowSums(is.na(merge_fiber10sIA)) == 0,]
merge_cable10sIA <- merge_cable10sIA[rowSums(is.na(merge_cable10sIA)) == 0,]
merge_dsl10sIA <- merge_dsl10sIA[rowSums(is.na(merge_dsl10sIA)) == 0,]
merge_t110sIA <- merge_t110sIA[rowSums(is.na(merge_t110sIA)) == 0,]
merge_fiber20sIA <- merge_fiber20sIA[rowSums(is.na(merge_fiber20sIA)) == 0,]
merge_cable20sIA <- merge_cable20sIA[rowSums(is.na(merge_cable20sIA)) == 0,]
merge_t120sIA <- merge_t120sIA[rowSums(is.na(merge_t120sIA)) == 0,]
merge_fiber30sIA <- merge_fiber30sIA[rowSums(is.na(merge_fiber30sIA)) == 0,]
merge_cable30sIA <- merge_cable30sIA[rowSums(is.na(merge_cable30sIA)) == 0,]
merge_dsl30sIA <- merge_dsl30sIA[rowSums(is.na(merge_dsl30sIA)) == 0,]
merge_t130sIA <- merge_t130sIA[rowSums(is.na(merge_t130sIA)) == 0,]
merge_darkfiber30sIA <- merge_darkfiber30sIA[rowSums(is.na(merge_darkfiber30sIA)) == 0,]
merge_wireless30sIA <- merge_wireless30sIA[rowSums(is.na(merge_wireless30sIA)) == 0,]
merge_fiber40sIA <- merge_fiber40sIA[rowSums(is.na(merge_fiber40sIA)) == 0,]
merge_cable40sIA <- merge_cable40sIA[rowSums(is.na(merge_cable40sIA)) == 0,]
merge_dsl40sIA <- merge_dsl40sIA[rowSums(is.na(merge_dsl40sIA)) == 0,]
merge_t140sIA <- merge_t140sIA[rowSums(is.na(merge_t140sIA)) == 0,]
merge_t340sIA <- merge_t340sIA[rowSums(is.na(merge_t340sIA)) == 0,]
merge_darkfiber40sIA <- merge_darkfiber40sIA[rowSums(is.na(merge_darkfiber40sIA)) == 0,]
merge_wireless40sIA <- merge_wireless40sIA[rowSums(is.na(merge_wireless40sIA)) == 0,]
powerfit_IA <- lm(mergeIA$lny ~ mergeIA$lnx, data=mergeIA)
powerfit_fiberIA <- lm(merge_fiberIA$lny ~ merge_fiberIA$lnx, data=merge_fiberIA)
powerfit_cableIA <- lm(merge_cableIA$lny ~ merge_cableIA$lnx, data=merge_cableIA)
powerfit_dslIA <- lm(merge_dslIA$lny ~ merge_dslIA$lnx, data=merge_dslIA)
powerfit_t1IA <- lm(merge_t1IA$lny ~ merge_t1IA$lnx, data=merge_t1IA)
powerfit_t3IA <- lm(merge_t3IA$lny ~ merge_t3IA$lnx, data=merge_t3IA)
powerfit_darkfiberIA <- lm(merge_darkfiberIA$lny ~ merge_darkfiberIA$lnx, data=merge_darkfiberIA)
powerfit_wirelessIA <- lm(merge_wirelessIA$lny ~ merge_wirelessIA$lnx, data=merge_wirelessIA)
powerfit10sIA <- lm(merge10sIA$lny ~ merge10sIA$lnx, data=merge10sIA)
powerfit20sIA <- lm(merge20sIA$lny ~ merge20sIA$lnx, data=merge20sIA)
powerfit30sIA <- lm(merge30sIA$lny ~ merge30sIA$lnx, data=merge30sIA)
powerfit40sIA <- lm(merge40sIA$lny ~ merge40sIA$lnx, data=merge40sIA)
powerfit41IA <- lm(merge41IA$lny ~ merge41IA$lnx, data=merge41IA)
powerfit42IA <- lm(merge42IA$lny ~ merge42IA$lnx, data=merge42IA)
powerfit43IA <- lm(merge43IA$lny ~ merge43IA$lnx, data=merge43IA)
powerfit_urbanIA <- lm(merge_urbanIA$lny ~ merge_urbanIA$lnx, data=merge_urbanIA)
powerfit_subtwnIA <- lm(merge_subtwnIA$lny ~ merge_subtwnIA$lnx, data=merge_subtwnIA)
powerfit_ruralIA <- lm(merge_ruralIA$lny ~ merge_ruralIA$lnx, data=merge_ruralIA)
powerfit_fiber10sIA <- lm(merge_fiber10sIA$lny ~ merge_fiber10sIA$lnx, data=merge_fiber10sIA)
powerfit_cable10sIA <- lm(merge_cable10sIA$lny ~ merge_cable10sIA$lnx, data=merge_cable10sIA)
powerfit_dsl10sIA <- lm(merge_dsl10sIA$lny ~ merge_dsl10sIA$lnx, data=merge_dsl10sIA)
powerfit_t110sIA <- lm(merge_t110sIA$lny ~ merge_t110sIA$lnx, data=merge_t110sIA)
powerfit_fiber20sIA <- lm(merge_fiber20sIA$lny ~ merge_fiber20sIA$lnx, data=merge_fiber20sIA)
powerfit_cable20sIA <- lm(merge_cable20sIA$lny ~ merge_cable20sIA$lnx, data=merge_cable20sIA)
powerfit_t120sIA <- lm(merge_t120sIA$lny ~ merge_t120sIA$lnx, data=merge_t120sIA)
powerfit_fiber30sIA <- lm(merge_fiber30sIA$lny ~ merge_fiber30sIA$lnx, data=merge_fiber30sIA)
powerfit_cable30sIA <- lm(merge_cable30sIA$lny ~ merge_cable30sIA$lnx, data=merge_cable30sIA)
powerfit_dsl30sIA <- lm(merge_dsl30sIA$lny ~ merge_dsl30sIA$lnx, data=merge_dsl30sIA)
powerfit_t130sIA <- lm(merge_t130sIA$lny ~ merge_t130sIA$lnx, data=merge_t130sIA)
powerfit_darkfiber30sIA <- lm(merge_darkfiber30sIA$lny ~ merge_darkfiber30sIA$lnx, data=merge_darkfiber30sIA)
powerfit_wireless30sIA <- lm(merge_wireless30sIA$lny ~ merge_wireless30sIA$lnx, data=merge_wireless30sIA)
powerfit_fiber40sIA <- lm(merge_fiber40sIA$lny ~ merge_fiber40sIA$lnx, data=merge_fiber40sIA)
powerfit_cable40sIA <- lm(merge_cable40sIA$lny ~ merge_cable40sIA$lnx, data=merge_cable40sIA)
powerfit_dsl40sIA <- lm(merge_dsl40sIA$lny ~ merge_dsl40sIA$lnx, data=merge_dsl40sIA)
powerfit_t140sIA <- lm(merge_t140sIA$lny ~ merge_t140sIA$lnx, data=merge_t140sIA)
powerfit_t340sIA <- lm(merge_t340sIA$lny ~ merge_t340sIA$lnx, data=merge_t340sIA)
powerfit_darkfiber40sIA <- lm(merge_darkfiber40sIA$lny ~ merge_darkfiber40sIA$lnx, data=merge_darkfiber40sIA)
powerfit_wireless40sIA <- lm(merge_wireless40sIA$lny ~ merge_wireless40sIA$lnx, data=merge_wireless40sIA)
q()
install.packages("RPostgreSQL")
library("RPostgreSQL", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
library("RPostgreSQL")
install.packages("sqldf")
library(sqldf)
drv <- dbDriver("PostgreSQL")
con <- dbConnect(drv, dbname = "daddkut7s5671q",
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
con <- dbConnect(drv, dbname = "daddkut7s5671q",
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
con <- dbConnect(drv, dbname = "daddkut7s5671q",
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
con <- dbConnect(drv, dbname = "daddkut7s5671q",
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
con <- dbConnect(drv, dbname = "daddkut7s5671q",
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
library(sqldf)
setwd("~/Desktop/SQL Queries")
drv <- dbDriver("PostgreSQL")
con <- dbConnect(drv, dbname = "daddkut7s5671q",
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
host = "ec2-54-204-38-194.compute-1.amazonaws.com", port = 5572,
user = "u3v583a3p2pp85", password = "p6omsea0tv60mlfjnosesb7ereu")
dbListFields(con, "districts")
usac2015 = read.csv("usac2015_31_3.csv", header=TRUE, sep="|")
usac2015$qty_bdwdth <- (usac2015$"No..of.Lines"*usac2015$"Mbps.Down.Speed")
usac2015$cost_per_mbps <- ifelse(usac2015$qty_bdwdth == 0, 0, (usac2015$"Total.Cost"/12/usac2015$qty_bdwdth))
usac2015$lny <- log10(usac2015$cost_per_mbps)
usac2015$lnx <- log10(usac2015$"Mbps.Down.Speed")
mergeIA <- usac2015[(usac2015$"Purpose"=="Internet"),]
mergeIA <- mergeIA[rowSums(is.na(mergeIA)) == 0,]
merge_fiberIA <- mergeIA[mergeIA$"Connect.Type"=="Lit Fiber Service" | mergeIA$"Connect.Type"=="OC-N",]
merge_cableIA <- mergeIA[mergeIA$"Connect.Type"=="Cable Modem",]
merge_dslIA <- mergeIA[mergeIA$"Connect.Type"=="Digital Subscriber Line (DSL)",]
merge_t1IA <- mergeIA[mergeIA$"Connect.Type"=="DS-1 (T-1)",]
merge_t3IA <- mergeIA[mergeIA$"Connect.Type"=="DS-3 (T-3)",]
merge_darkfiberIA <- mergeIA[mergeIA$"Connect.Type"=="Dark Fiber Service",]
merge_wirelessIA <- mergeIA[mergeIA$"Connect.Type"=="E.g., Microwave Service",]
merge10sIA <- usac2015[((usac2015$locale==11 | usac2015$locale==12 | usac2015$locale==13) & usac2015$"Purpose"=="Internet"),]
merge20sIA <- usac2015[((usac2015$locale==21 | usac2015$locale==22 | usac2015$locale==23) & usac2015$"Purpose"=="Internet"),]
merge30sIA <- usac2015[((usac2015$locale==31 | usac2015$locale==32 | usac2015$locale==33) & usac2015$"Purpose"=="Internet"),]
merge40sIA <- usac2015[((usac2015$locale==41 | usac2015$locale==42 | usac2015$locale==43) & usac2015$"Purpose"=="Internet"),]
setwd("C:/Users/Justine/Desktop")
business <- read.table("mydata.csv", header=TRUE, sep=",", row.names="id")
setwd("C:/")
business <- read.table("business.csv", header=TRUE, sep=",", row.names="id")
setwd("C:/Users/Justine/Documents/")"
business <- read.table("business.csv", header=TRUE, sep=",", row.names="id")
setwd("C:/Users/Justine/Documents/")
business <- read.table("business.csv", header=TRUE, sep=",", row.names="id")
business_categories <- read.table("business.csv", header=TRUE, sep=",", row.names="id")
business <- read.table("business.csv", header=TRUE)
business <- read.table("business.csv", header=TRUE, sep=",", row.names="business_id")
business_categories <- read.table("business.csv", header=TRUE, sep=",", row.names="business_id")
view(business)
head(business)
library(sqldf)
business_category_restaurant <- sqldf ("
select *
from business_categories
where catergory = 'Restaurants'
")
business_category_restaurant <- sqldf ("
select *
from business_categories
where "catergory" = 'Restaurants'
")
head(business_categories)
head(business_categories)
summary(business_categories)
""
;
)
sf
summary(business_categories)
csv", header=TRUE, sep=",", row.names="business_id")
business_categories <- read.table("business_categories.csv", header=TRUE, sep=",", row.names="business_id")
business_categories_2 <- read.table("business_categories.csv", header=TRUE, sep=",", row.names="business_id")
business_categories_2 <- read.table("business_categories.csv", header=TRUE, sep=",")
business_category_restaurant <- sqldf ("
select *
from business_categories_2
where "catergory" = 'Restaurants'
")
business_category_restaurant <- sqldf ("
select *
from business_categories_2
where catergory = 'Restaurants'
")
business_category_restaurant <- sqldf ("  select *
from business_categories_2
where catergory = 'Restaurants'")
business_category_restaurant <- sqldf (  select *
from business_categories_2
where catergory = 'Restaurants'
)
business_category_restaurant <- sqldf ('select * from business_categories_2 where catergory = 'Restaurants'')
business_category_restaurant = sqldf ('select * from business_categories_2 where catergory = 'Restaurants'')
business_category_restaurant = sqldf (select * from business_categories_2 where catergory = 'Restaurants')
business_category_restaurant = sqldf (‘select * from business_categories_2 where catergory = 'Restaurants'’)
bw_connect.mreg <- rfsrc(Multivar(bandwidth_in_mbps.y, connect_category.y) ~., data = joined[train_vector,])
library(randomForestSRC)
mtcars.mreg <- rfsrc(Multivar(mpg, cyl) ~., data = mtcars)
print(mtcars.mreg, outcome.target = "mpg")
plot(mtcars.mreg, outcome.target = "mpg")
nrow(joined)
setwd("C:/Users/Justine/Documents/GitHub/ficher/Research Project Analysis/Machine Learn Clean")
orig <- read.csv('orig_broadband_line_items.csv') # predictors
verified <- read.csv('verified_broadband_line_items.csv') # outcome
joined <- merge(orig, verified, by.x=c("frn","frn_line_item_no"), by.y=c("frn","frn_line_item_no"))
head(joined)
class(joined$rec_elig_cost.y)
joined$rec_elig_cost.y <- as.numeric(as.character(joined$rec_elig_cost.y))
joined <- joined[!is.na(joined$rec_elig_cost.y),]
nrow(joined)
data.size <- nrow(joined)
train.size <- round(data.size *.8, 0)
dev.size <- data.size - train.size
train_vector <- sample(data.size, train.size)
mtcars.mreg <- rfsrc(Multivar(mpg, cyl) ~., data = mtcars)
head(mtcars)
mtcars.mreg <- rfsrc(Multivar(mpg, cyl) ~., data = mtcars)
plot(mtcars.mreg, outcome.target = "mpg")
print(mtcars.mreg, outcome.target = "mpg")
nrow(mtcars)
View(joined)
View(joined)
mini_joined <- joined[,c(5,8,10,11,12,13,15,18,19,26,36,38)]
mini_joined
head(mini_joined)
data.size <- nrow(mini_joined)
train.size <- round(data.size *.8, 0)
dev.size <- data.size - train.size
train_vector <- sample(data.size, train.size)
data.size
train.size
train_data <- mini_joined[train_vector,])
train_data <- mini_joined[train_vector,]
head(train_data)
nrow(train_data)
train.size
train_data <- mini_joined[23,]
head(train_data)
nrow(train_data)
bw_connect.mreg <- rfsrc(Multivar(bandwidth_in_mbps.y, connect_category.y) ~., data = train_data)
print(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
print(bw_connect.mreg, outcome.target = "connect_category.y")
plot(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
plot(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
print(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
bw_connect.mreg <- rfsrc(Multivar(bandwidth_in_mbps.y, connect_category.y) ~., data = train_data)
train_data <- mini_joined[23,]
train_data
train_data <- mini_joined[1:23,]
head(train_data)
nrow(train_data)
train_data
bw_connect.mreg <- rfsrc(Multivar(bandwidth_in_mbps.y, connect_category.y) ~., data = train_data)
print(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
plot(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
print(bw_connect.mreg, outcome.target = "connect_category.y")
plot(bw_connect.mreg, outcome.target = "connect_category.y")
train_data <- mini_joined[1:train.size,]
nrow(train_data)
bw_connect.mreg <- rfsrc(Multivar(bandwidth_in_mbps.y, connect_category.y) ~., data = train_data)
print(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
print(bw_connect.mreg, outcome.target = "connect_category.y")
mtcars.mreg <- rfsrc(Multivar(mpg, cyl) ~., data = mtcars)
print(mtcars.mreg, outcome.target = "mpg")
print(mtcars.mreg, outcome.target = "cyl")
print(bw_connect.mreg, outcome.target = "connect_category.y")
print(bw_connect.mreg, outcome.target = "connect_category.y")
plot(bw_connect.mreg, outcome.target = "connect_category.y")
plot(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
print(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
print(bw_connect.mreg, outcome.target = "connect_category.y")
plot(mtcars.mreg, outcome.target = "mpg")
print(mtcars.mreg, outcome.target = "mpg")
print(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
plot(bw_connect.mreg, outcome.target = "bandwidth_in_mbps.y")
bw.reg <- rfsrc(bandwidth_in_mbps.y ~., data = train_data)
connect.reg <- rfsrc(connect.y ~., data = train_data)
connect.reg <- rfsrc(connect_category.y ~., data = train_data)
View(mini_joined)
train_data.bw <- train_data[,c(1:11)]
train_data.connect <- train_data[,c(1:10,12)]
nrow(train_data)
