shiny::runApp()
shiny::runApp()
runApp()
runApp()
library(RPostgreSQL)
runApp()
runApp()
runApp()
runApp()
cat("\014")
wd <- "~/Desktop/ficher/Shiny/prep_for_Shiny"
setwd(wd)
services <- read.csv("services_received_20160517.csv", as.is = TRUE)
districts <- read.csv("deluxe_districts_20160517.csv", as.is = TRUE)
discounts <- read.csv("district_discount_rates_20160414.csv", as.is = TRUE)
usac_matrix <- read.csv("usac_discount_matrix.csv", as.is = TRUE)
schools_needing_wan <- read.csv("schools_needing_wan_20160428.csv", as.is = TRUE)
usac_matrix <- read.csv("usac_discount_matrix.csv", as.is = TRUE)
View(usac_matrix)
View(discounts)
View(discounts)
discounts <- dplyr::select(discounts, esh_id, c1_discount_rate_max)
discounts <- arrange(discounts, esh_id, -c1_discount_rate_max)
services <- read.csv("services_received_20160517.csv", as.is = TRUE)
districts <- read.csv("deluxe_districts_20160517.csv", as.is = TRUE)
discounts <- read.csv("district_discount_rates_20160414.csv", as.is = TRUE)
usac_matrix <- read.csv("usac_discount_matrix.csv", as.is = TRUE)
schools_needing_wan <- read.csv("schools_needing_wan_20160428.csv", as.is = TRUE)
discounts <- dplyr::select(discounts, esh_id, c1_discount_rate_max)
discounts <- arrange(discounts, esh_id, -c1_discount_rate_max)
discounts <- discounts[!duplicated(discounts$esh_id), ]
discounts <- arrange(discounts, esh_id, -c1_discount_rate_max)
services <- read.csv("services_received_20160517.csv", as.is = TRUE)
districts <- read.csv("deluxe_districts_20160517.csv", as.is = TRUE)
discounts <- read.csv("district_discount_rates_20160414.csv", as.is = TRUE)
usac_matrix <- read.csv("usac_discount_matrix.csv", as.is = TRUE)
schools_needing_wan <- read.csv("schools_needing_wan_20160428.csv", as.is = TRUE)
discounts <- dplyr::select(discounts, esh_id, c1_discount_rate_max)
discounts2 <- arrange(discounts, esh_id, -c1_discount_rate_max)
discounts <- arrange(discounts, esh_id, -c1_discount_rate_max)
discounts2 <- discounts[!duplicated(discounts$esh_id), ]
12103-11844
dups <- discounts2 <- discounts[duplicated(discounts$esh_id), ]
View(dups)
dups2 <- discounts[discounts$esh_id %in% dups$esh_id, ]
dups2
View(dups2)
View(dups)
View(dups2)
discounts <- discounts[!duplicated(discounts$esh_id), ]
names(discounts)  <- c("esh_id", "c1_discount_rate")
districts <- left_join(districts, discounts, by = c("esh_id"))
missing_discount_rate_urban <- which(is.na(districts$c1_discount_rate) &
districts$locale %in% c("Suburban", "Urban"))
missing_discount_rate_rural <- which(is.na(districts$c1_discount_rate) &
districts$locale %in% c("Rural", "Small Town"))
View(districts[missing_discount_rate_urban, ])
districts$frl_percent
usac_matrix$frl_ceiling
View(usac_matrix)
View(usac_matrix)
View(usac_matrix)
View(usac_matrix)
is.na(districts$frl_percent)
which(is.na(districts$frl_percent) & is.na(districts$c1_discount_rate))
length(which(is.na(districts$frl_percent) & is.na(districts$c1_discount_rate)))
districts$usac_c1_urban <-
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[1], usac_matrix$c1_urban[1],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[2], usac_matrix$c1_urban[2],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[3], usac_matrix$c1_urban[3],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[4], usac_matrix$c1_urban[4], usac_matrix$c1_urban[5]))))
districts$usac_c1_rural <-
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[1], usac_matrix$c1_rural[1],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[2], usac_matrix$c1_rural[2],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[3], usac_matrix$c1_rural[3],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[4], usac_matrix$c1_rural[4], usac_matrix$c1_rural[5]))))
districts[missing_discount_rate_urban, ]$c1_discount_rate <- districts[missing_discount_rate_urban, ]$usac_c1_urban
districts[missing_discount_rate_rural, ]$c1_discount_rate <- districts[missing_discount_rate_rural, ]$usac_c1_rural
is.na(districts$c1_discount_rate)
districts$usac_c1_rural <-
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[1], usac_matrix$c1_rural[1],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[2], usac_matrix$c1_rural[2],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[3], usac_matrix$c1_rural[3],
ifelse(districts$frl_percent < usac_matrix$frl_ceiling[4], usac_matrix$c1_rural[4], usac_matrix$c1_rural[5]))))
districts[missing_discount_rate_urban, ]$c1_discount_rate <- districts[missing_discount_rate_urban, ]$usac_c1_urban
districts[missing_discount_rate_rural, ]$c1_discount_rate <- districts[missing_discount_rate_rural, ]$usac_c1_rural
is.na(districts$c1_discount_rate)
sum(is.na(districts$c1_discount_rate))
sum(is.na(districts$c1_discount_rate) & is.na(districts$frl_percent))
View(districts[districts$postal_cd == "MN", c("esh_id", "frl_percent", "c1_discount_rate")])
View(districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, c("esh_id", "frl_percent", "c1_discount_rate")])
View(districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE & districts$c1_discount_rate %in% c(70, 80), c("esh_id", "frl_percent", "c1_discount_rate")])
districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, c("esh_id", "frl_percent", "c1_discount_rate")])
districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, c("esh_id", "frl_percent", "c1_discount_rate")]
districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, c("esh_id", "frl_percent", "c1_discount_rate")]$esh_id
test <- districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, c("esh_id", "frl_percent", "c1_discount_rate")])
test
test <- districts[districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, c("esh_id", "frl_percent", "c1_discount_rate")]
test
View(districts[districts$esh_id %in% test])
View(districts[districts$esh_id %in% test$esh_id])
test
names(test)
View(districts[districts$esh_id %in% test$esh_id,])
View(districts[districts$c1_discount_rate == 40 & districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, ])
districts$schools_on_fiber <- ((districts$nga_v2_known_scalable_campuses + districts$nga_v2_assumed_scalable_campuses)  / districts$num_campuses) * districts$num_schools
districts$schools_may_need_upgrades <- (districts$nga_v2_assumed_unscalable_campuses / districts$num_campuses) * districts$num_schools
districts$schools_need_upgrades <- (districts$nga_v2_known_unscalable_campuses / districts$num_campuses) * districts$num_schools
districts$schools_on_fiber <- ((districts$nga_v2_known_scalable_campuses + districts$nga_v2_assumed_scalable_campuses)  / districts$num_campuses) * districts$num_schools
districts$schools_may_need_upgrades <- (districts$nga_v2_assumed_unscalable_campuses / districts$num_campuses) * districts$num_schools
districts$schools_need_upgrades <- (districts$nga_v2_known_unscalable_campuses / districts$num_campuses) * districts$num_schools
View(districts[districts$c1_discount_rate == 40 & districts$postal_cd == "MN" & districts$exclude_from_analysis == FALSE, ])
runApp('~/Desktop/ficher/Shiny')
runApp('~/Desktop/ficher/Shiny')
library(RPostgreSQL)
runApp('~/Desktop/ficher/Shiny')
runApp('~/Desktop/ficher/Shiny')
runApp('~/Desktop/ficher/Shiny')
